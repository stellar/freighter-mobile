# Utility flow for reliable text input on iOS and Android
# Workaround for inputText flakily skipping/mangling characters (especially in CI env)
# Based on: https://github.com/mobile-dev-inc/Maestro/issues/2382#issuecomment-2750423163
#
# Usage Example (in a Maestro flow file):
#   - runFlow:
#       file: ../utils/input-text.yaml
#       env:
#         INPUT_TEXT: "your text here"
#
# Functionality:
# This flow splits the INPUT_TEXT into single characters and inputs each one sequentially
# to minimize skipped letters that may otherwise occur if input is too fast for the simulator/emulator to process.
#
# Input Variables:
# - INPUT_TEXT (string, required): The text string to input reliably.
#
# Implementation Notes:
# The flow initializes a counter and inputs characters one by one using a repeat loop.
# The small batching and delay should improve reliability, but feel free to tune for your environment.
#
# Example integration: see onboarding/ImportWallet.yaml for real-world usage.

appId: org.stellar.freighterdev
---
- evalScript: ${output.counter = 0}
- repeat:
    optional: true
    while:
      true: ${output.counter < INPUT_TEXT.length}
    commands:
      - inputText: ${INPUT_TEXT.charAt(output.counter)}
      - evalScript: ${output.counter = output.counter + 1}
